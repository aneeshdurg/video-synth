<head>
    <link rel="stylesheet" href="style.css">
    <script src="https://aneeshdurg.me/webgl-common/common.js"></script>
    <script>
    class Function {
        id = 0;
        feedback = 0;
        params = {};
        enable = true;

        constructor(feedback) {
            this.feedback = feedback;
        }
    }
    </script>
    <script src="ui.js"></script>
    <script src="customui.js"></script>
    <script src="function_generator.js"></script>
    <script src="synth_element_base.js"></script>
    <script src="module_lib.js"></script>
    <script src="meta_module.js"></script>
    <script src="saveload.js"></script>
    <script src="synth.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            await loadTwgl();
            synth_main(document.getElementById("glcanvas"));
        });
    </script>
</head>
<body>
    <div class="sidebar">
        <div id="ui">
            <h1 class="title">Video Synthesizer</h1>
            <div id="controls">
                <button id="controls-prev" class="controls-prev">prev</button>
                <button id="controls-next" class="controls-next">next</button>
                <br>
                <div id ="controls-0">
                    <h2> Add new stage </h2>
                    <div id="add_new_generator_container">
                        <p> Generators </p>
                        <select id="add_new_generator_select"></select>
                        <button id="add_new_generator">Add</button>
                    </div>
                    <div id="add_new_space_container" style="display: none">
                        <p> Space Effects </p>
                        <select id="add_new_space_select"></select>
                        <button id="add_new_space">Add</button>
                    </div>
                    <div id="add_new_color_container" style="display: none">
                        <p> Color Effects </p>
                        <select id="add_new_color_select"></select>
                        <button id="add_new_color">Add</button>
                    </div>
                    <br>
                    <button id="add_new-prev" class="controls-prev">prev</button>
                    <button id="add_new-next" class="controls-next">next</button>
                    <br>
                </div>
                <div id="controls-1" style="display: none">
                    <div>
                        <h2> Add/create meta module </h2>
                        <p>
                        Combine multiple stages into a <i>meta module</i>!
                        </p>
                        <button id="create-module">Create</button>
                        <!-- TODO edit/delete -->
                        <div id="add-meta-module" style="display: none;">
                            <button id="add-meta">Add new</button>
                            <select id="add-meta-select"></select>
                        </div>
                    </div>
                </div>
                <div id="controls-2" style="display: none">
                    <h2> Save / Load </h2>
                    <p>
                    Save the current synth or load a previous save
                    </p>
                    <button id="save">Save current synth</button>
                    <br>
                    <br>
                    <label for="load">Load: </label>
                    <input id="load" type="file" accept="text/*"></text>
                </div>
                <!--
                <div id="controls-3" style="display: none">
                    <h2> Record </h2>
                    <input
                        type="number"
                        min="0"
                        value="100"
                        id="record-duration"></input>
                    <button id="Record">Record</button>
                </div>
                -->
            </div>
            <br>
            <hr>
            <br>
            <div id="ui-container"></div>
        </div>
    </div>
    <div class="display-container">
        <canvas id="glcanvas"></canvas>
    </div>
</body>
